<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Using loops to process multiple samples | RNA-seq gene expression and pathway analysis - supplemental material</title>
  <meta name="description" content="NEOF book for the Metabarcoding for diet analysis and environmental DNA workshop - supplemental material" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Using loops to process multiple samples | RNA-seq gene expression and pathway analysis - supplemental material" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/figures/NEOF.png" />
  <meta property="og:description" content="NEOF book for the Metabarcoding for diet analysis and environmental DNA workshop - supplemental material" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Using loops to process multiple samples | RNA-seq gene expression and pathway analysis - supplemental material" />
  
  <meta name="twitter:description" content="NEOF book for the Metabarcoding for diet analysis and environmental DNA workshop - supplemental material" />
  <meta name="twitter:image" content="/figures/NEOF.png" />

<meta name="author" content="Katy Maher, Helen Hipperson, Steve Paterson, Bert Overduin, Matthew Gemmell, Xuan Liu" />


<meta name="date" content="2024-06-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="figures/NEOF_favicon.png" type="image/x-icon" />
<link rel="prev" href="03-Further_DESeq2.html"/>
<link rel="next" href="05-WGCNA.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="www/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="https://neof.org.uk/" target="blank"><img src="figures/NEOF_bordered_small.png"></a></li>
<li><a>RNA-seq</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="01-Supplemental.html"><a href="01-Supplemental.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="01-Supplemental.html"><a href="01-Supplemental.html#table-of-contents"><i class="fa fa-check"></i>Table of contents</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-Count_table.html"><a href="02-Count_table.html"><i class="fa fa-check"></i><b>2</b> Making a count table from HTSeq output files</a></li>
<li class="chapter" data-level="3" data-path="03-Further_DESeq2.html"><a href="03-Further_DESeq2.html"><i class="fa fa-check"></i><b>3</b> Further analysis with DESeq2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Further_DESeq2.html"><a href="03-Further_DESeq2.html#control-for-sex-of-fly"><i class="fa fa-check"></i><b>3.1</b> Control for sex of fly</a></li>
<li class="chapter" data-level="3.2" data-path="03-Further_DESeq2.html"><a href="03-Further_DESeq2.html#fit-with-multiple-groups"><i class="fa fa-check"></i><b>3.2</b> Fit with multiple groups</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Multiple_samples_loops.html"><a href="04-Multiple_samples_loops.html"><i class="fa fa-check"></i><b>4</b> Using loops to process multiple samples</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Multiple_samples_loops.html"><a href="04-Multiple_samples_loops.html#simple-loop-example"><i class="fa fa-check"></i><b>4.1</b> Simple loop example</a></li>
<li class="chapter" data-level="4.2" data-path="04-Multiple_samples_loops.html"><a href="04-Multiple_samples_loops.html#trimmomatic-loop-example"><i class="fa fa-check"></i><b>4.2</b> Trimmomatic loop example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-WGCNA.html"><a href="05-WGCNA.html"><i class="fa fa-check"></i><b>5</b> Gene Co-expression Network Analysis with WGCNA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-WGCNA.html"><a href="05-WGCNA.html#introduction-to-wgcna"><i class="fa fa-check"></i><b>5.1</b> Introduction to WGCNA</a></li>
<li class="chapter" data-level="5.2" data-path="05-WGCNA.html"><a href="05-WGCNA.html#set-up"><i class="fa fa-check"></i><b>5.2</b> Set up</a></li>
<li class="chapter" data-level="5.3" data-path="05-WGCNA.html"><a href="05-WGCNA.html#checking-hierarchical-clustering"><i class="fa fa-check"></i><b>5.3</b> Checking hierarchical clustering</a></li>
<li class="chapter" data-level="5.4" data-path="05-WGCNA.html"><a href="05-WGCNA.html#network-construction"><i class="fa fa-check"></i><b>5.4</b> Network construction</a></li>
<li class="chapter" data-level="5.5" data-path="05-WGCNA.html"><a href="05-WGCNA.html#module-detection"><i class="fa fa-check"></i><b>5.5</b> Module detection</a></li>
<li class="chapter" data-level="5.6" data-path="05-WGCNA.html"><a href="05-WGCNA.html#module-treatment-correlation"><i class="fa fa-check"></i><b>5.6</b> Module-treatment correlation</a></li>
<li class="chapter" data-level="5.7" data-path="05-WGCNA.html"><a href="05-WGCNA.html#network-plots-and-hub-genes"><i class="fa fa-check"></i><b>5.7</b> Network plots and hub genes</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RNA-seq gene expression and pathway analysis - supplemental material</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multisamples" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Using loops to process multiple samples<a href="04-Multiple_samples_loops.html#multisamples" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<center>
<img src="figures/loop.png" style="width:200px; background:white; border-radius:15px" />
</center>
<p>In our main workflow we learnt how to run through our RNA-seq analysis pipeline with a single sample up until the differential gene expression step, where we provided you with an example data set containing multiple samples. You may be wondering how you would run these initial steps when you have many samples.</p>
<p>Ideally you don't want to have to run the same command multiple times - this is a recipe for typos and errors creeping into your code as well as being tedious and time consuming.</p>
<p>One approach to get around this is to run a loop which will cycle through each of your samples running the task you specify.</p>
<p>Put simply the syntax for a <code>for loop</code> is as follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb19-1"><a href="04-Multiple_samples_loops.html#cb19-1" tabindex="-1"></a><span class="cf">for</span> <span class="op">&lt;</span>variable <span class="ex">name</span><span class="op">&gt;</span> in <span class="op">&lt;</span>a list of items<span class="op">&gt;</span><span class="kw">;</span></span>
<span id="cb19-2"><a href="04-Multiple_samples_loops.html#cb19-2" tabindex="-1"></a><span class="cf">do</span> <span class="op">&lt;</span>run <span class="ex">a</span> command<span class="op">&gt;</span> $<span class="op">&lt;</span>variable name<span class="op">&gt;</span><span class="kw">;</span></span>
<span id="cb19-3"><a href="04-Multiple_samples_loops.html#cb19-3" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>The <code>&lt;variable name&gt;</code> is the name of the variable you will use in the <code>do</code> part of your loop.
It contains the item in your list the loop is currently using at that point.
I.e. in the simple loop example (below) we call this variable <code>f</code> but you could use any name as long as you use it consistently in your <code>do</code> section.</p>
<p>The <code>&lt;a list of items&gt;</code> is anything that returns a list of items, e.g. a list of files in our case.</p>
<div id="simple-loop-example" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Simple loop example<a href="04-Multiple_samples_loops.html#simple-loop-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<center>
<img src="figures/data_files.png" style="width:200px" />
</center>
<p>Below is an example of a loop, which can be adjusted for your samples and the software you are running.
This simplified loop will clearly demonstrate what the first part of the code is doing.</p>
<p>Make sure you are in the directory <code>rnaseq/Practical_one</code> and in a terminal window (not in Jupyter).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb20-1"><a href="04-Multiple_samples_loops.html#cb20-1" tabindex="-1"></a><span class="co">#The following will loop through all files ending _R1.fq.gz</span></span>
<span id="cb20-2"><a href="04-Multiple_samples_loops.html#cb20-2" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> <span class="pp">*</span>_R1.fq.gz<span class="kw">;</span></span>
<span id="cb20-3"><a href="04-Multiple_samples_loops.html#cb20-3" tabindex="-1"></a><span class="co">#assign the file name &#39;$f&#39; to a variable called &#39;BASE&#39; but remove the extension &#39;_R1.fq.gz&#39;</span></span>
<span id="cb20-4"><a href="04-Multiple_samples_loops.html#cb20-4" tabindex="-1"></a><span class="cf">do</span> <span class="va">BASE</span><span class="op">=</span><span class="va">${f</span><span class="op">%</span>_R1.fq.gz<span class="va">}</span></span>
<span id="cb20-5"><a href="04-Multiple_samples_loops.html#cb20-5" tabindex="-1"></a>  <span class="co">#print $f to screen</span></span>
<span id="cb20-6"><a href="04-Multiple_samples_loops.html#cb20-6" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$f</span></span>
<span id="cb20-7"><a href="04-Multiple_samples_loops.html#cb20-7" tabindex="-1"></a>    <span class="co">#print ${BASE} to screen</span></span>
<span id="cb20-8"><a href="04-Multiple_samples_loops.html#cb20-8" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">${BASE}</span><span class="kw">;</span> </span>
<span id="cb20-9"><a href="04-Multiple_samples_loops.html#cb20-9" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>By using <code>echo</code> to print the following variables to the console we can see:</p>
<ul>
<li><code>echo $f</code>: prints the full filename.</li>
<li><code>echo ${BASE}</code>: prints just the start of the filename (minus the _R1.fq.gz extension as we specified in our code)</li>
</ul>
<p>The loop then repeats the commands on the next file in the list and will keep going until it has run through all files ending with <code>_R1.fq.gz</code> in the given directory.</p>
<p><code>done</code> specifies the end of the commands in the loop.</p>
<p>All commands between <code>do</code> and <code>done</code> in your loop will be executed. In this case we only have two files but this would work with any number of files. This is a useful bit of code as it means we can keep the filename but change the ending/extension of the file in our loops.</p>
</div>
<div id="trimmomatic-loop-example" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Trimmomatic loop example<a href="04-Multiple_samples_loops.html#trimmomatic-loop-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<center>
<img src="figures/quality_trimming_and_filtering.png" style="width:200px" />
</center>
<p>Now we can write a loop to run trimmomatic starting with the code we used above as a base.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb21-1"><a href="04-Multiple_samples_loops.html#cb21-1" tabindex="-1"></a><span class="co">#the following will loop through all files ending _R1.fq.gz</span></span>
<span id="cb21-2"><a href="04-Multiple_samples_loops.html#cb21-2" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> <span class="pp">*</span>_R1.fq.gz<span class="kw">;</span> </span>
<span id="cb21-3"><a href="04-Multiple_samples_loops.html#cb21-3" tabindex="-1"></a><span class="co">#assign the file name &#39;$f&#39; to a variable called &#39;BASE&#39; but remove the extension &#39;_R1.fq.gz&#39;</span></span>
<span id="cb21-4"><a href="04-Multiple_samples_loops.html#cb21-4" tabindex="-1"></a><span class="cf">do</span> <span class="va">BASE</span><span class="op">=</span><span class="va">${f</span><span class="op">%</span>_R1.fq.gz<span class="va">}</span> </span>
<span id="cb21-5"><a href="04-Multiple_samples_loops.html#cb21-5" tabindex="-1"></a>  <span class="co">#call trimmomatic and specify parameters</span></span>
<span id="cb21-6"><a href="04-Multiple_samples_loops.html#cb21-6" tabindex="-1"></a>    <span class="ex">trimmomatic</span> PE <span class="at">-threads</span> 4 <span class="at">-phred33</span> <span class="dt">\ </span></span>
<span id="cb21-7"><a href="04-Multiple_samples_loops.html#cb21-7" tabindex="-1"></a>    <span class="co">#specify input R1 extension</span></span>
<span id="cb21-8"><a href="04-Multiple_samples_loops.html#cb21-8" tabindex="-1"></a>    <span class="va">${BASE}</span><span class="ex">_R1.fq.gz</span> <span class="dt">\ </span></span>
<span id="cb21-9"><a href="04-Multiple_samples_loops.html#cb21-9" tabindex="-1"></a>    <span class="co">#specify input R2 extension</span></span>
<span id="cb21-10"><a href="04-Multiple_samples_loops.html#cb21-10" tabindex="-1"></a>    <span class="va">${BASE}</span><span class="ex">_R2.fq.gz</span> <span class="dt">\ </span></span>
<span id="cb21-11"><a href="04-Multiple_samples_loops.html#cb21-11" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of paired R1 read</span></span>
<span id="cb21-12"><a href="04-Multiple_samples_loops.html#cb21-12" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_R1_out_paired.fastq</span> <span class="dt">\ </span></span>
<span id="cb21-13"><a href="04-Multiple_samples_loops.html#cb21-13" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of unpaired R1 read</span></span>
<span id="cb21-14"><a href="04-Multiple_samples_loops.html#cb21-14" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_R1_out_unpaired.fastq</span> <span class="dt">\ </span></span>
<span id="cb21-15"><a href="04-Multiple_samples_loops.html#cb21-15" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of paired R2 read</span></span>
<span id="cb21-16"><a href="04-Multiple_samples_loops.html#cb21-16" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_R2_out_paired.fastq</span> <span class="dt">\ </span></span>
<span id="cb21-17"><a href="04-Multiple_samples_loops.html#cb21-17" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of unpaired R2 read</span></span>
<span id="cb21-18"><a href="04-Multiple_samples_loops.html#cb21-18" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_R2_out_unpaired.fastq</span> <span class="dt">\ </span></span>
<span id="cb21-19"><a href="04-Multiple_samples_loops.html#cb21-19" tabindex="-1"></a>    <span class="co">#further paramenters for trimmomatic</span></span>
<span id="cb21-20"><a href="04-Multiple_samples_loops.html#cb21-20" tabindex="-1"></a>    <span class="ex">ILLUMINACLIP:TruSeq3-PE-2.fa:2:30:12</span> SLIDINGWINDOW:4:30 MINLEN:80<span class="kw">;</span></span>
<span id="cb21-21"><a href="04-Multiple_samples_loops.html#cb21-21" tabindex="-1"></a><span class="co">#end of commands</span></span>
<span id="cb21-22"><a href="04-Multiple_samples_loops.html#cb21-22" tabindex="-1"></a><span class="cf">done</span> </span></code></pre></div>
<p>You can then edit this code to run other software in a loop. For a nice basic intro to Linux loops please click <a href="https://www.redhat.com/sysadmin/bash-scripting-loops">here</a>.</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="03-Further_DESeq2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="05-WGCNA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
