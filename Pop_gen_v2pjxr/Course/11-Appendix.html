<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A Mamba installs | Population Genomics</title>
  <meta name="description" content="NEOF book for the Metabarcoding for diet analysis and environmental DNA workshop" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="A Mamba installs | Population Genomics" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/figures/NEOF.png" />
  <meta property="og:description" content="NEOF book for the Metabarcoding for diet analysis and environmental DNA workshop" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Mamba installs | Population Genomics" />
  
  <meta name="twitter:description" content="NEOF book for the Metabarcoding for diet analysis and environmental DNA workshop" />
  <meta name="twitter:image" content="/figures/NEOF.png" />

<meta name="author" content="Helen Hipperson, Katy Maher, Victor Soria-Carrasco, Graeme Fox" />


<meta name="date" content="2023-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="figures/NEOF_favicon.png" type="image/x-icon" />
<link rel="prev" href="10-GWAS.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="www/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="https://neof.org.uk/" target="blank"><img src="figures/neof_small_logo.png"></a></li>
<li><a>Population Genomics</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting started</b></span></li>
<li class="chapter" data-level="1" data-path="01-Intro.html"><a href="01-Intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="01-Intro.html"><a href="01-Intro.html#table-of-contents"><i class="fa fa-check"></i>Table of contents</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-Background.html"><a href="02-Background.html"><i class="fa fa-check"></i><b>2</b> Background</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Background.html"><a href="02-Background.html#example-data-whole-genome-resequencing-of-killer-whales"><i class="fa fa-check"></i><b>2.1</b> Example data: Whole-genome resequencing of killer whales</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-Cluster_Introduction.html"><a href="03-Cluster_Introduction.html"><i class="fa fa-check"></i><b>3</b> Cluster Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Cluster_Introduction.html"><a href="03-Cluster_Introduction.html#logon-instructions"><i class="fa fa-check"></i><b>3.1</b> Logon instructions</a></li>
<li class="chapter" data-level="3.2" data-path="03-Cluster_Introduction.html"><a href="03-Cluster_Introduction.html#the-terminal-window"><i class="fa fa-check"></i><b>3.2</b> The Terminal Window</a></li>
<li class="chapter" data-level="3.3" data-path="03-Cluster_Introduction.html"><a href="03-Cluster_Introduction.html#accessing-the-example-data"><i class="fa fa-check"></i><b>3.3</b> Accessing the example data</a></li>
</ul></li>
<li class="part"><span><b>Generating SNP datasets</b></span></li>
<li class="chapter" data-level="4" data-path="04-QC.html"><a href="04-QC.html"><i class="fa fa-check"></i><b>4</b> QC Tutorials</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-QC.html"><a href="04-QC.html#workshop-data"><i class="fa fa-check"></i><b>4.1</b> Workshop data</a></li>
<li class="chapter" data-level="4.2" data-path="04-QC.html"><a href="04-QC.html#killer-whale-genomic-dataset"><i class="fa fa-check"></i><b>4.2</b> Killer whale genomic dataset</a></li>
<li class="chapter" data-level="4.3" data-path="04-QC.html"><a href="04-QC.html#quality-assessment"><i class="fa fa-check"></i><b>4.3</b> Quality assessment</a></li>
<li class="chapter" data-level="4.4" data-path="04-QC.html"><a href="04-QC.html#quality-control"><i class="fa fa-check"></i><b>4.4</b> Quality control</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="04-QC.html"><a href="04-QC.html#post-quality-control-check"><i class="fa fa-check"></i><b>4.4.1</b> Post Quality control check</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-Mapping.html"><a href="05-Mapping.html"><i class="fa fa-check"></i><b>5</b> Mapping sequences to the reference genome using BWA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Mapping.html"><a href="05-Mapping.html#reference-sequence-preparation"><i class="fa fa-check"></i><b>5.1</b> Reference sequence preparation</a></li>
<li class="chapter" data-level="5.2" data-path="05-Mapping.html"><a href="05-Mapping.html#read-mapping"><i class="fa fa-check"></i><b>5.2</b> Read mapping</a></li>
<li class="chapter" data-level="5.3" data-path="05-Mapping.html"><a href="05-Mapping.html#assessing-mapping-results"><i class="fa fa-check"></i><b>5.3</b> Assessing mapping results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-SNPs.html"><a href="06-SNPs.html"><i class="fa fa-check"></i><b>6</b> SNP and genotype calling using SAMtools and BCFtools</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-SNPs.html"><a href="06-SNPs.html#file-preparation"><i class="fa fa-check"></i><b>6.1</b> File preparation</a></li>
<li class="chapter" data-level="6.2" data-path="06-SNPs.html"><a href="06-SNPs.html#variant-calling"><i class="fa fa-check"></i><b>6.2</b> Variant calling</a></li>
<li class="chapter" data-level="6.3" data-path="06-SNPs.html"><a href="06-SNPs.html#variant-filtering"><i class="fa fa-check"></i><b>6.3</b> Variant filtering</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="06-SNPs.html"><a href="06-SNPs.html#extracting-information"><i class="fa fa-check"></i><b>6.3.1</b> Extracting information</a></li>
<li class="chapter" data-level="6.3.2" data-path="06-SNPs.html"><a href="06-SNPs.html#subsetting-files"><i class="fa fa-check"></i><b>6.3.2</b> Subsetting files</a></li>
<li class="chapter" data-level="6.3.3" data-path="06-SNPs.html"><a href="06-SNPs.html#filtering"><i class="fa fa-check"></i><b>6.3.3</b> Filtering</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Analysis</b></span></li>
<li class="chapter" data-level="7" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html"><i class="fa fa-check"></i><b>7</b> Population structure with NGSadmix and PCA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#ngsadmix"><i class="fa fa-check"></i><b>7.1</b> NGSadmix</a></li>
<li class="chapter" data-level="7.2" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#jupyter"><i class="fa fa-check"></i><b>7.2</b> Jupyter</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#open-jupyter-notebook"><i class="fa fa-check"></i><b>7.2.1</b> Open Jupyter-notebook</a></li>
<li class="chapter" data-level="7.2.2" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#create-r-notebook"><i class="fa fa-check"></i><b>7.2.2</b> Create R notebook</a></li>
<li class="chapter" data-level="7.2.3" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#cells-and-code"><i class="fa fa-check"></i><b>7.2.3</b> Cells and code</a></li>
<li class="chapter" data-level="7.2.4" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#create-new-cells"><i class="fa fa-check"></i><b>7.2.4</b> Create new cells</a></li>
<li class="chapter" data-level="7.2.5" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#running-code"><i class="fa fa-check"></i><b>7.2.5</b> Running code</a></li>
<li class="chapter" data-level="7.2.6" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#saving-the-file"><i class="fa fa-check"></i><b>7.2.6</b> Saving the file</a></li>
<li class="chapter" data-level="7.2.7" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#title-cells-with-markdown"><i class="fa fa-check"></i><b>7.2.7</b> Title cells with markdown</a></li>
<li class="chapter" data-level="7.2.8" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#close-the-notebook"><i class="fa fa-check"></i><b>7.2.8</b> Close the notebook</a></li>
<li class="chapter" data-level="7.2.9" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#video-tutorial"><i class="fa fa-check"></i><b>7.2.9</b> Video tutorial</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#admixture-plots"><i class="fa fa-check"></i><b>7.3</b> Admixture plots</a></li>
<li class="chapter" data-level="7.4" data-path="07-NGSAdmix.html"><a href="07-NGSAdmix.html#pca"><i class="fa fa-check"></i><b>7.4</b> PCA</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-Summary_stats.html"><a href="08-Summary_stats.html"><i class="fa fa-check"></i><b>8</b> Calculating population summary statistics using PopGenome</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-Summary_stats.html"><a href="08-Summary_stats.html#getting-started"><i class="fa fa-check"></i><b>8.1</b> Getting started</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-Detecting_selection.html"><a href="09-Detecting_selection.html"><i class="fa fa-check"></i><b>9</b> Delimitation of contiguous regions of differentiation using Hidden Markov Models (HMM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-Detecting_selection.html"><a href="09-Detecting_selection.html#initial-set-up"><i class="fa fa-check"></i><b>9.1</b> Initial set up</a></li>
<li class="chapter" data-level="9.2" data-path="09-Detecting_selection.html"><a href="09-Detecting_selection.html#data-formatting"><i class="fa fa-check"></i><b>9.2</b> Data formatting</a></li>
<li class="chapter" data-level="9.3" data-path="09-Detecting_selection.html"><a href="09-Detecting_selection.html#allele-frequency-estimation"><i class="fa fa-check"></i><b>9.3</b> Allele frequency estimation</a></li>
<li class="chapter" data-level="9.4" data-path="09-Detecting_selection.html"><a href="09-Detecting_selection.html#fst-estimation"><i class="fa fa-check"></i><b>9.4</b> F<sub>ST</sub> estimation</a></li>
<li class="chapter" data-level="9.5" data-path="09-Detecting_selection.html"><a href="09-Detecting_selection.html#delimitation-of-contiguous-regions-of-differentiation-using-a-hmm-model"><i class="fa fa-check"></i><b>9.5</b> Delimitation of contiguous regions of differentiation using a HMM model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-GWAS.html"><a href="10-GWAS.html"><i class="fa fa-check"></i><b>10</b> Genetic architecture of traits using multi-locus Genome Wide Association (GWA) mapping with GEMMA</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-GWAS.html"><a href="10-GWAS.html#initial-set-up-1"><i class="fa fa-check"></i><b>10.1</b> Initial set up</a></li>
<li class="chapter" data-level="10.2" data-path="10-GWAS.html"><a href="10-GWAS.html#data-formatting-1"><i class="fa fa-check"></i><b>10.2</b> Data formatting</a></li>
<li class="chapter" data-level="10.3" data-path="10-GWAS.html"><a href="10-GWAS.html#running-gemma-to-fit-a-bayesian-sparse-linear-mixed-model-bslmm"><i class="fa fa-check"></i><b>10.3</b> Running GEMMA to fit a Bayesian sparse linear mixed model (BSLMM)</a></li>
<li class="chapter" data-level="10.4" data-path="10-GWAS.html"><a href="10-GWAS.html#analysing-gemma-bslmm-output"><i class="fa fa-check"></i><b>10.4</b> Analysing GEMMA BSLMM output</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="11-Appendix.html"><a href="11-Appendix.html"><i class="fa fa-check"></i><b>A</b> Mamba installs</a>
<ul>
<li class="chapter" data-level="A.1" data-path="11-Appendix.html"><a href="11-Appendix.html#mamba-installation-and-environment"><i class="fa fa-check"></i><b>A.1</b> Mamba installation and environment</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="11-Appendix.html"><a href="11-Appendix.html#jupyter_appendix"><i class="fa fa-check"></i><b>B</b> Jupyter-notebook</a></li>
<li class="chapter" data-level="C" data-path="11-Appendix.html"><a href="11-Appendix.html#loops"><i class="fa fa-check"></i><b>C</b> Using loops to process multiple samples</a>
<ul>
<li class="chapter" data-level="C.1" data-path="11-Appendix.html"><a href="11-Appendix.html#simple-loop-example"><i class="fa fa-check"></i><b>C.1</b> Simple loop example</a></li>
<li class="chapter" data-level="C.2" data-path="11-Appendix.html"><a href="11-Appendix.html#trimmomatic-loop-example"><i class="fa fa-check"></i><b>C.2</b> Trimmomatic loop example</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="11-Appendix.html"><a href="11-Appendix.html#an-overview-of-bayesian-statistics"><i class="fa fa-check"></i><b>D</b> An overview of Bayesian statistics</a></li>
<li class="chapter" data-level="E" data-path="11-Appendix.html"><a href="11-Appendix.html#additional-approaches-for-detecting-selection-and-for-gwas"><i class="fa fa-check"></i><b>E</b> Additional approaches for detecting selection and for GWAS</a>
<ul>
<li class="chapter" data-level="E.1" data-path="11-Appendix.html"><a href="11-Appendix.html#rehh"><i class="fa fa-check"></i><b>E.1</b> rehh</a></li>
<li class="chapter" data-level="E.2" data-path="11-Appendix.html"><a href="11-Appendix.html#gcta"><i class="fa fa-check"></i><b>E.2</b> GCTA</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Population Genomics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mamba_install" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">A</span> Mamba installs<a href="11-Appendix.html#mamba_install" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="figures/mamba_logo.png" width="20%" style="display: block; margin: auto;" /></p>
<div id="mamba-installation-and-environment" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">A.1</span> Mamba installation and environment<a href="11-Appendix.html#mamba-installation-and-environment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Mamba is a reimplementation of conda. It is a great tool for installing bioinformatic packages including R packages.</p>
<p>Mamba github: <a href="https://github.com/mamba-org/mamba" class="uri">https://github.com/mamba-org/mamba</a></p>
<p>The best way to use Mamba is to install Miniforge. It has both Conda and Mamba commands.</p>
<p>Miniforge installation: <a href="https://github.com/conda-forge/miniforge" class="uri">https://github.com/conda-forge/miniforge</a></p>
<p>Mamba guide: <a href="https://mamba.readthedocs.io/en/latest/user_guide/mamba.html" class="uri">https://mamba.readthedocs.io/en/latest/user_guide/mamba.html</a></p>
<p>To create the mamba environment <code>popgenomics</code> run the below commands in your bash. You will need to have installed <code>mamba</code> first.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb142-1"><a href="11-Appendix.html#cb142-1" tabindex="-1"></a><span class="co">#R community</span></span>
<span id="cb142-2"><a href="11-Appendix.html#cb142-2" tabindex="-1"></a><span class="ex">mamba</span> create <span class="at">-n</span> popgenomics</span>
<span id="cb142-3"><a href="11-Appendix.html#cb142-3" tabindex="-1"></a><span class="ex">mamba</span> activate popgenomics</span>
<span id="cb142-4"><a href="11-Appendix.html#cb142-4" tabindex="-1"></a><span class="co">#Install packages from bioconda channel</span></span>
<span id="cb142-5"><a href="11-Appendix.html#cb142-5" tabindex="-1"></a><span class="co">#NGSadmix is part of angsd</span></span>
<span id="cb142-6"><a href="11-Appendix.html#cb142-6" tabindex="-1"></a><span class="ex">mamba</span> install <span class="at">-c</span> bioconda plink fastqc trimmomatic bwa samtools bcftools angsd r-popgenome gemma</span></code></pre></div>
</div>
</div>
<div id="jupyter_appendix" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">B</span> Jupyter-notebook<a href="11-Appendix.html#jupyter_appendix" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="figures/jupyter_logo.png" width="15%" style="display: block; margin: auto;" /></p>
<p>If you are running this on your own computer you can use <code>RStudio</code> for <code>R</code>.
However, you can also use <a href="https://jupyter.org/"><code>Jupyter-notebook</code></a> if you are using an HPC or prefer it.</p>
<p>If using bash you will need to create an environment with <code>Jupyter-notebook</code>.
Ensure you are in the <code>(base)</code> mamba environment.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb143-1"><a href="11-Appendix.html#cb143-1" tabindex="-1"></a><span class="ex">mamba</span> create <span class="at">-n</span> jupyter</span>
<span id="cb143-2"><a href="11-Appendix.html#cb143-2" tabindex="-1"></a><span class="ex">mamba</span> activate jupyter</span>
<span id="cb143-3"><a href="11-Appendix.html#cb143-3" tabindex="-1"></a><span class="ex">mamba</span> install <span class="at">-c</span> anaconda jupyter</span>
<span id="cb143-4"><a href="11-Appendix.html#cb143-4" tabindex="-1"></a><span class="ex">mamba</span> deactivate</span></code></pre></div>
<p>To run <code>Jupyter-notebook</code> with your <code>r_community</code> environment you can run the following.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb144-1"><a href="11-Appendix.html#cb144-1" tabindex="-1"></a><span class="co">#Activate you R_community env</span></span>
<span id="cb144-2"><a href="11-Appendix.html#cb144-2" tabindex="-1"></a><span class="ex">mamba</span> activate r_community</span>
<span id="cb144-3"><a href="11-Appendix.html#cb144-3" tabindex="-1"></a><span class="co">#Run jupyter-notebook (may be a slightly different path)</span></span>
<span id="cb144-4"><a href="11-Appendix.html#cb144-4" tabindex="-1"></a><span class="ex">~/mamba/envs/jupyter/bin/jupyter-notebook</span></span></code></pre></div>
</div>
<div id="loops" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">C</span> Using loops to process multiple samples<a href="11-Appendix.html#loops" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="figures/loop.png" width="25%" style="display: block; margin: auto;" /></p>
<p>In our main workflow we learnt how to run the QC and alignment steps using a single sample. You may be wondering how you would run these initial steps when you have many samples.</p>
<p>Ideally you don't want to have to run the same command multiple times - this is a recipe for typos and errors creeping into your code as well as being tedious and time consuming.</p>
<p>One approach to get around this is to run a loop which will cycle through each of your samples running the task you specify.</p>
<p>Put simply the syntax for a <code>for loop</code> is as follows:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb145-1"><a href="11-Appendix.html#cb145-1" tabindex="-1"></a><span class="cf">for</span> <span class="op">&lt;</span>variable <span class="ex">name</span><span class="op">&gt;</span> in <span class="op">&lt;</span>a list of items<span class="op">&gt;</span><span class="kw">;</span></span>
<span id="cb145-2"><a href="11-Appendix.html#cb145-2" tabindex="-1"></a><span class="cf">do</span> <span class="op">&lt;</span>run <span class="ex">a</span> command<span class="op">&gt;</span> $<span class="op">&lt;</span>variable name<span class="op">&gt;</span><span class="kw">;</span></span>
<span id="cb145-3"><a href="11-Appendix.html#cb145-3" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>The <code>&lt;variable name&gt;</code> is the name of the variable you will use in the <code>do</code> part of your loop.
It contains the item in your list the loop is currently using at that point.
I.e. in the simple loop example (below) we call this variable <code>f</code> but you could use any name as long as you use it consistently in your <code>do</code> section.</p>
<p>The <code>&lt;a list of items&gt;</code> is anything that returns a list of items, e.g. a list of files in our case.</p>
<div id="simple-loop-example" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">C.1</span> Simple loop example<a href="11-Appendix.html#simple-loop-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="figures/data_files.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Below is an example of a loop, which can be adjusted for your samples and the software you are running.
This simplified loop will clearly demonstrate what the first part of the code is doing.</p>
<p>Make sure you are in the directory <code>~/popgenomics/data/fastq/</code> and in a terminal window (not in Jupyter).</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb146-1"><a href="11-Appendix.html#cb146-1" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> <span class="pp">*</span>_1_small.fastq.gz<span class="kw">;</span> <span class="co">#the following will loop through all files ending _1_small.fastq.gz</span></span>
<span id="cb146-2"><a href="11-Appendix.html#cb146-2" tabindex="-1"></a><span class="cf">do</span> <span class="va">BASE</span><span class="op">=</span><span class="va">${f</span><span class="op">%</span>_1_small.fastq.gz<span class="va">}</span> <span class="co">#assign the file name &#39;$f&#39; to a variable called &#39;BASE&#39; but remove the extension &#39;_1_small.fastq.gz&#39;</span></span>
<span id="cb146-3"><a href="11-Appendix.html#cb146-3" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$f</span> <span class="co">#print $f to screen</span></span>
<span id="cb146-4"><a href="11-Appendix.html#cb146-4" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">${BASE}</span><span class="kw">;</span> <span class="co">#print ${BASE} to screen</span></span>
<span id="cb146-5"><a href="11-Appendix.html#cb146-5" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>By using <code>echo</code> to print the following variables to the console we can see:</p>
<ul>
<li><code>echo $f</code>: prints the full filename.</li>
<li><code>echo ${BASE}</code>: prints just the start of the filename (minus the _1_small.fastq.gz extension as we specified in our code)</li>
</ul>
<p>The loop then repeats the commands on the next file in the list (in this case we only have one file) and will keep going until it has run through all files ending with <code>_1_small.fastq.gz</code> in the given directory.</p>
<p><code>done</code> specifies the end of the commands in the loop.</p>
<p>All commands between <code>do</code> and <code>done</code> in your loop will be executed. In this case we only have two files but this would work with any number of files. This is a useful bit of code as it means we can keep the filename but change the ending/extension of the file in our loops.</p>
</div>
<div id="trimmomatic-loop-example" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">C.2</span> Trimmomatic loop example<a href="11-Appendix.html#trimmomatic-loop-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="figures/quality_trimming_and_filtering.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Now we can write a loop to run trimmomatic starting with the code we used above as a base.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb147-1"><a href="11-Appendix.html#cb147-1" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> <span class="pp">*</span>_1_small.fastq.gz<span class="kw">;</span> <span class="co">#the following will loop through all files ending _1_small.fastq.gz</span></span>
<span id="cb147-2"><a href="11-Appendix.html#cb147-2" tabindex="-1"></a><span class="cf">do</span> <span class="va">BASE</span><span class="op">=</span><span class="va">${f</span><span class="op">%</span>_1_small.fastq.gz<span class="va">}</span> <span class="co">#assign the file name &#39;$f&#39; to a variable called &#39;BASE&#39; but remove the extension &#39;_1_small.fastq.gz&#39;</span></span>
<span id="cb147-3"><a href="11-Appendix.html#cb147-3" tabindex="-1"></a>    <span class="ex">trimmomatic</span> PE <span class="at">-threads</span> 4 <span class="at">-phred33</span> <span class="dt">\ </span></span>
<span id="cb147-4"><a href="11-Appendix.html#cb147-4" tabindex="-1"></a>    <span class="co">#call trimmomatic and specify parameters</span></span>
<span id="cb147-5"><a href="11-Appendix.html#cb147-5" tabindex="-1"></a>    <span class="va">${BASE}</span><span class="ex">_1_small.fastq.gz</span> <span class="dt">\ </span></span>
<span id="cb147-6"><a href="11-Appendix.html#cb147-6" tabindex="-1"></a>    <span class="co">#specify input R1 extension</span></span>
<span id="cb147-7"><a href="11-Appendix.html#cb147-7" tabindex="-1"></a>    <span class="va">${BASE}</span><span class="ex">_2_small.fastq.gz</span> <span class="dt">\ </span></span>
<span id="cb147-8"><a href="11-Appendix.html#cb147-8" tabindex="-1"></a>    <span class="co">#specify input R2 extension</span></span>
<span id="cb147-9"><a href="11-Appendix.html#cb147-9" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_1_out_paired.fastq</span> <span class="dt">\ </span></span>
<span id="cb147-10"><a href="11-Appendix.html#cb147-10" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of paired R1 read</span></span>
<span id="cb147-11"><a href="11-Appendix.html#cb147-11" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_1_out_unpaired.fastq</span> <span class="dt">\ </span></span>
<span id="cb147-12"><a href="11-Appendix.html#cb147-12" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of unpaired R1 read</span></span>
<span id="cb147-13"><a href="11-Appendix.html#cb147-13" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_2_out_paired.fastq</span> <span class="dt">\ </span></span>
<span id="cb147-14"><a href="11-Appendix.html#cb147-14" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of paired R2 read</span></span>
<span id="cb147-15"><a href="11-Appendix.html#cb147-15" tabindex="-1"></a>    <span class="ex">trimmed/</span><span class="va">${BASE}</span><span class="ex">_2_out_unpaired.fastq</span> <span class="dt">\ </span></span>
<span id="cb147-16"><a href="11-Appendix.html#cb147-16" tabindex="-1"></a>    <span class="co">#specify directory and filename for output of unpaired R2 read</span></span>
<span id="cb147-17"><a href="11-Appendix.html#cb147-17" tabindex="-1"></a>    <span class="ex">ILLUMINACLIP:TruSeq3-PE-2.fa:2:30:12</span> SLIDINGWINDOW:4:30 MINLEN:80<span class="kw">;</span>  <span class="co">#further paramenters for trimmomatic</span></span>
<span id="cb147-18"><a href="11-Appendix.html#cb147-18" tabindex="-1"></a><span class="cf">done</span> <span class="co">#end of commands</span></span></code></pre></div>
<p>You can then edit this code to run other software in a loop. For a nice basic intro to Linux loops please click <a href="https://www.redhat.com/sysadmin/bash-scripting-loops">here</a>.</p>
</div>
</div>
<div id="an-overview-of-bayesian-statistics" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">D</span> An overview of Bayesian statistics<a href="11-Appendix.html#an-overview-of-bayesian-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="figures/Bayes.PNG" width="20%" style="display: block; margin: auto;" />
As indicated in the presentations and used in some of the workshop analyses, many tools incorporate Bayesian approaches or statistics over other approaches. For example, population structure, admixture and ancestry can be examined using NGSadmix, which uses a maximum-likelihood approach, or STRUCTURE, which uses a Bayesian approach, and <code>GEMMA</code> for GWAS can implement a number of different models under a Bayesian framework. But, what does a Bayesian approach actually entail? <a href="https://statswithr.github.io/book/index.html">This resource</a> and <a href="https://vioshyvo.github.io/Bayesian_inference/index.html">this one</a> are useful introductions - they are easy to follow and not too intimidating. (The latter includes some R exercises to demonstrate some principles).</p>
<p>The core philosophy of Bayesian statistics is built around the concept of conditional probability, with analyses aiming to maximise this conditional probability or to minimise the uncertainty in parameter space around this. This conditional probability is the probability or likelihood of observing a particular outcome given (i.e. conditional on) the data, a model and some prior information (a prior). (Paradoxically, it is actually the probability of observing the data, given the model, the priors and the outcome). The ability to include prior information is key, and an advantage of the approach is that it evaluates potential outcomes and all the parameters that underlie these simultaneously. It also lends itself to being iterative; the priors and their influence on the conditional probabilities can be explored, refined or updated through repeated analyses or by incorporating additional data.
<img src="figures/MCMC.PNG" width="40%" style="display: block; margin: auto;" />
In many cases, Bayesian approaches are favoured, not because of the ability to incorporate this prior, but because they are computationally efficient. If one can conceptualise a particular solution or result as lying at a given point in parameter space, a typical maximum likelihood approach may use an exhaustive or heuristic procedure to evaluate all points in that space, calculating a likelihood or probability given the model and data, and eventually compare these. In most cases, this is computationally restrictive and/or time-consuming. Bayesian approaches employ much more efficient sampling algorithms, such as MCMC <a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">(Markov chain Monte Carlo)</a>, as conducted when implementing the BSLMM model in <code>GEMMA</code>, to sample posterior probability distributions. Multiple chains will move around and selectively sample various points in parameter space, comparing the conditional probabilities among the chains themselves and to the prior sampled states, and retain those points (and the parameters underlying them) from the posterior probability distribution if there was an improvement in conditional probability. In doing so, eventually the chains and sampling will converge around the “true result”, as in the figure above, taken from <a href="http://faculty.washington.edu/wjs18/MCMC_Bayesian/Lewis_200TREE.pdf">this paper</a>. While the chains might not necessarily hit on the exact result, there will be sufficient sampling around the “true result” that one can synthesise the information from multiple sampled “generations”, and obtain average values around the optimum. As such, it can provide useful information around uncertainty in our data, models and priors, allowing us to evaluate confidence intervals easily, and potentially change parameters, priors or add data. An unfortunate drawback of this approach is the possibility that the sampling gets trapped in local optima in parameter space (the points in the bottom right corner in the figure) rather than sampling near the “true result”. Thus, it is often advised to run multiple iterations of Bayesian analyses, modifying the starting parameters of the search, where the applications allow this.</p>
<p>There are additional aspects to be aware of. There is a longstanding debate as to whether Bayesian statistics have frequentist properties (and may be interpreted as one would interpret more traditional frequentist statistics, especially when evaluating significance) or whether they are entirely probabilistic. Often this conflict results from subtle differences in philosophical perspective; see <a href="https://bids.berkeley.edu/news/bayesians-v-frequentists-tale-old-time">this example</a>. Additionally, when designing an experiment or choosing an analytical approach, Bayesian and frequentist approaches can yield different outcomes, with frequentist approaches often being more sensitive than Bayesian counterparts to how the hypotheses to be tested are framed or approached.</p>
</div>
<div id="additional-approaches-for-detecting-selection-and-for-gwas" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">E</span> Additional approaches for detecting selection and for GWAS<a href="11-Appendix.html#additional-approaches-for-detecting-selection-and-for-gwas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="rehh" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">E.1</span> rehh<a href="11-Appendix.html#rehh" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="figures/rehh.png" width="20%" style="display: block; margin: auto;" />
<a href="https://cran.r-project.org/package=rehh"><code>rehh</code></a> is a R package which is used to explore SNP data and identify genomic regions that have been under recent positive selection (where advantageous variants are retained and increase in prevalence) in a single population or species, or to examine differential selection between two populations. A handy vignette (from which the above graph was taken) is available <a href="https://cran.r-project.org/web/packages/rehh/vignettes/rehh.html">here</a>. The approach is based on the concept of Extended Haplotype Homozygosity (EHH) (or a long-range haplotype test) proposed by Sabeti et al. <a href="https://www.nature.com/articles/nature01140">2002</a>. Fundamentally, it considers the relationship between allele frequencies and linkage disequilibrium (LD). Under neutral evolution, mutations require time to establish in a population, by which time LD would have broken down around these mutations through recombination. Under recent positive selection, mutations increase in frequency rapidly, before LD has a chance to break down, and these extended haplotypes are then transmitted without recombination.</p>
<p>EHH is the probability that a pair of randomly-chosen chromosomes are identical by descent and homozygous for those SNPs which we have genotyped and mapped at a given distance from a core region of interest (presented as haplotypes of increasing length) on that chromosome. Values range from 0, where all these extended haplotypes are different, to 1, where all are homozygous. EHH is then considered relatively, where the EHH of the tested core haplotype is compared with the EHHs of other core haplotypes in the same region (but excluding other core haplotypes). Through this, the approach detects the breakdown of linkage disequilibrium as one moves further away from the core region. Core haplotypes in regions that have high EHH and are at high frequency in the population indicate mutations that have likely been established through non-neutral evolution.</p>
<p>The approach appears to be more powerful than many traditional metrics, but it can be complex to implement. To reconstruct the extended haplotypes, genotype data are phased, where each of the alleles of a given SNP genotype is assigned to a hypothetical haplotype. This is obviously straightforward when many loci are homozygous, but as one moves away from the SNP of interest (central in the core haplotype) and encounters heterozygous SNP genotypes the number of hypothetical haplotypes increases exponentially. There are a number of tools and approaches for phasing haplotypes, and a useful (albeit dated) review was published by Browning &amp; Browning <a href="http://www.biostat.ulg.ac.be/pages/BIM/Theory/browning_browning_nature_review_genetics2011.pdf">2011</a>. As input, <code>rehh</code> can accept haplotype data in various formats, including vcf-formatted data, and those produced by phasing programmes like <a href="https://mathgen.stats.ox.ac.uk/genetics_software/shapeit/shapeit.html">SHAPEIT2</a> and <a href="http://scheet.org/software.html">fastPHASE</a>.</p>
</div>
<div id="gcta" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">E.2</span> GCTA<a href="11-Appendix.html#gcta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="figures/GCTA.PNG" width="20%" style="display: block; margin: auto;" />
GCTA <a href="https://yanglab.westlake.edu.cn/software/gcta/#Overview">Genome-wide Complex Trait Analysis</a> is a package that runs within a Linux/Unix environment, although there are installs and executables for Mac and Windows too. Yang et al. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3014363/">2011</a> originally developed it to determine the proportions of phenotypic variance of a complex trait that can be explained by genome-wide SNP variation. It was since expanded to and focused on many different and powerful GWAS applications, and it now supports a wide range of analyses, including relatedness and inbreeding, heritability and LD estimation, as well as more traditional population genetic statistics.</p>
<p>The program takes binary PED files, generated by PLINK, as input files. As with many applications for GWAS, only biallelic SNPs are supported at the moment, and multiallelic SNPs are automatically ignored.</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="10-GWAS.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
